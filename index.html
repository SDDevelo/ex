<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Калькулятор ціни б/у шин</title>
<style>
/* ====== СТИЛІ ====== */
:root {--bg:#0f1115;--card:#151923;--text:#e6e8ef;--muted:#9aa3b2;--accent:#7aa2ff;--line:#232836;--ok:#8bd17c;}
*{box-sizing:border-box;}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,"Helvetica Neue",Arial;color:var(--text);background:var(--bg);}
header{text-align:center;padding:20px;}
h1{margin:0 0 10px;}
.sub{color:var(--muted);margin:0;}
main{max-width:900px;margin:auto;padding:15px;}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:18px;margin:14px 0;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;}
label{display:flex;flex-direction:column;gap:4px;}
input,select,button{background:#0d1017;color:var(--text);border:1px solid var(--line);border-radius:8px;padding:8px;}
button{cursor:pointer;}
.price{font-size:32px;font-weight:700;color:var(--ok);}
.label{color:var(--muted);}
.result{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center;}
.muted{color:var(--muted);}
</style>
</head>
<body>
<header>
<h1>Калькулятор ціни б/у шин</h1>
<p class="sub">Округлення до 50₴, розрахунок за радіусом, протектором, роком та популярністю</p>
</header>
<main>
<section class="card">
<div class="grid">
<label>Повний розмір<input id="size" placeholder="205/55 R16"></label>
<label>Протектор, мм<input id="tread" type="number" step="0.1" value="5.5"></label>
<label>Рік<input id="year" type="number" value="2020"></label>
<label>Популярність<select id="popularity"><option value="auto">Авто</option><option value="very">Дуже</option><option value="mid">Середня</option><option value="low">Низька</option><option value="rare">Рідкісна</option></select></label>
<label>К-сть<input id="qty" type="number" value="1"></label>
</div>
<p><button id="calc">Розрахувати</button></p>
<p id="parsed" class="muted"></p>
</section>
<section class="card">
<div class="result">
<div><div class="price" id="priceEach">—</div><div class="label">за 1</div></div>
<div><div class="price" id="priceTotal">—</div><div class="label" id="qtyLabel">за комплект</div></div>
</div>
<div id="explain" class="muted"></div>
</section>
</main>
<script>
/* ====== СКРИПТ ====== */
const RANGES={R14:{min:980,max:1290},R15:{min:1190,max:1590},R16:{min:1490,max:2080},R17:{min:1790,max:2490},R18:{min:2090,max:2790},R19:{min:2290,max:3090},R20:{min:2590,max:3490},R21:{min:2990,max:3980},R22:{min:3490,max:4480}};
const POP={very:new Set(["195/65R15","205/55R16","215/65R16","225/45R17"]),mid:new Set(["185/65R15","205/60R16","215/55R17","235/55R18"]),low:new Set(["175/65R14","225/60R16","245/45R18","255/40R19"]),rare:new Set(["165/70R14","245/50R17","265/35R20","285/30R21"])};
const POP_COEF={very:1,mid:0.95,low:0.9,rare:1.1};
function mid(r){return Math.round((r.min+r.max)/2);}
function parseSize(s){const m=s.trim().toUpperCase().replace(/\s+/g,'').match(/^(\d{3})\/(\d{2})R?(\d{2})$/);return m?{radius:+m[3],norm:`${m[1]}/${m[2]}R${m[3]}`}:null;}
function yearCoef(y){if(y<=2015)return 0.8;if(y<=2017)return 0.88;if(y<=2019)return 0.95;if(y<=2021)return 1;if(y<=2023)return 1.05;return 1.1;}
function treadCoef(mm){return 1+Math.min((mm-5)*0.1,0.3);}
function popAuto(n){for(let k in POP){if(POP[k].has(n))return k;}return"very";}
function round25(x){return Math.round(x/25)*25;}
function clamp(x,a,b){return Math.max(a,Math.min(b,x));}
function fmt(x){return x.toLocaleString("uk-UA");}
document.getElementById("calc").onclick=()=>{
  const size=parseSize(document.getElementById("size").value||"");
  if(!size){document.getElementById("parsed").textContent="Невірний формат";return;}
  document.getElementById("parsed").textContent=`Розпізнано: ${size.norm}`;
  const tread=parseFloat(document.getElementById("tread").value),year=parseInt(document.getElementById("year").value),qty=parseInt(document.getElementById("qty").value);
  let pop=document.getElementById("popularity").value;if(pop==="auto")pop=popAuto(size.norm);
  const base=mid(RANGES["R"+size.radius]),price=base*treadCoef(tread)*yearCoef(year)*POP_COEF[pop],rounded=round50(price),final=clamp(rounded,RANGES["R"+size.radius].min,RANGES["R"+size.radius].max);
  document.getElementById("priceEach").textContent=fmt(final)+"₴";
  document.getElementById("priceTotal").textContent=fmt(final*qty)+"₴";
  document.getElementById("qtyLabel").textContent=qty>1?`за ${qty} шт.`:"за комплект";
  document.getElementById("explain").innerHTML=`База R${size.radius}: ${fmt(base)}₴; протектор ×${treadCoef(tread).toFixed(2)}, рік ×${yearCoef(year).toFixed(2)}, популярність ×${POP_COEF[pop].toFixed(2)}`;
};
</script>
</body>
</html>
